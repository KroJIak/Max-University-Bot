# Scripts

Вспомогательные скрипты для разработки и тестирования проекта Max University Bot.

## Содержание

- [test_api.py](#test_apipy) - Тестирование API endpoints
- [scraper.py](#scraperpy) - Скраппинг документации
- [check_ajax.py](#check_ajaxpy) - Проверка AJAX запросов
- [html_to_md.py](#html_to_mdpy) - Конвертация HTML в Markdown

---

## test_api.py

Скрипт для тестирования всех API endpoints проекта.

### Описание

Автоматизированное тестирование всех эндпоинтов API, включая:
- Health check
- Университеты (CRUD операции, аутентификация)
- Пользователи (CRUD операции)
- Студенты (логин, статус, credentials, расписание, персональные данные, преподаватели, контакты, платформы)
- Конфигурация университета

### Использование

```bash
# Тестирование с дефолтным URL (http://localhost:8003)
python test_api.py

# Тестирование с кастомным URL
python test_api.py --base-url http://localhost:8000
```

### Особенности

- Цветной вывод результатов в консоль
- Подробная информация о каждом тесте
- Автоматическое создание тестовых данных
- Пропуск деструктивных операций (удаление) для сохранения тестовых данных
- Сводка результатов в конце выполнения

### Требования

- Python 3.7+
- `requests` библиотека

---

## scraper.py

Скраппер для скачивания документации с сайта https://dev.max.ru/docs.

### Описание

Скачивает документацию с сохранением структуры директорий. Поддерживает:
- Автоматическое обнаружение основных вкладок (Документация, API, MAX UI)
- Рекурсивный парсинг боковой панели навигации
- Сохранение структуры папок
- Извлечение только содержимого блока `<main>` из HTML

### Использование

```bash
python scraper.py
```

### Настройки

По умолчанию:
- Базовый URL: `https://dev.max.ru`
- Выходная директория: `docs/`

Можно изменить в коде:
```python
scraper = MaxDocsScraper(
    base_url="https://dev.max.ru",
    output_dir="docs"
)
```

### Требования

- Python 3.7+
- `requests`
- `beautifulsoup4`

### Установка зависимостей

```bash
pip install requests beautifulsoup4
```

---

## check_ajax.py

Скрипт для проверки AJAX запросов на странице personal_data.php.

### Описание

Помогает понять, какие AJAX запросы выполняются для загрузки данных студента. Анализирует:
- JavaScript код на странице
- AJAX вызовы (jQuery, fetch, XMLHttpRequest)
- JavaScript переменные с данными
- Input поля на странице

### Использование

```python
# В коде скрипта нужно указать:
# - URL страницы
# - Cookies для аутентификации

check_page_for_ajax_urls(
    url="https://lk.chuvsu.ru/student/personal_data.php",
    cookies={
        "PHPSESSID": "your_session_id",
        # другие cookies
    }
)
```

### Рекомендации

Для ручной проверки:
1. Откройте страницу в браузере с Developer Tools (F12)
2. Перейдите на вкладку "Network" (Сеть)
3. Обновите страницу (F5)
4. Отфильтруйте запросы по типу 'XHR' или 'Fetch'
5. Проверьте ответы этих запросов - там могут быть данные студента

### Требования

- Python 3.7+
- `requests`
- `beautifulsoup4`

---

## html_to_md.py

Конвертер HTML файлов в Markdown формат.

### Описание

Конвертирует все HTML файлы из директории `docs/` в Markdown файлы в директории `docs_md/`. Особенности:
- Сохранение структуры директорий
- Автоматическое преобразование ссылок в относительные пути
- Копирование изображений с обновлением путей
- Упрощение структуры директорий (удаление лишних вложенных папок)
- Пропуск папки "MAX UI" (копируется без конвертации)

### Использование

```bash
python html_to_md.py
```

### Настройки

По умолчанию:
- Исходная директория: `docs/`
- Выходная директория: `docs_md/`

Можно изменить в коде:
```python
converter = HTMLToMarkdownConverter(
    source_dir="docs",
    output_dir="docs_md"
)
```

### Требования

- Python 3.7+
- `beautifulsoup4`
- `html2text`

### Установка зависимостей

```bash
pip install beautifulsoup4 html2text
```

### Особенности конвертации

- Ссылки автоматически преобразуются в относительные пути
- Изображения копируются в выходную директорию
- Якорные ссылки сохраняются
- Внешние ссылки остаются без изменений
- Удаляются лишние пустые строки
- Упрощается форматирование заголовков

---

## Установка всех зависимостей

Для установки всех необходимых зависимостей для всех скриптов:

```bash
pip install requests beautifulsoup4 html2text
```

Или используйте виртуальное окружение:

```bash
python -m venv .venv
source .venv/bin/activate  # Linux/Mac
# или
.venv\Scripts\activate  # Windows

pip install requests beautifulsoup4 html2text
```

---

## Структура директорий

После выполнения скриптов может появиться следующая структура:

```
scripts/
├── README.md
├── test_api.py
├── scraper.py
├── check_ajax.py
├── html_to_md.py
├── docs/              # Результат работы scraper.py
│   ├── Документация/
│   ├── API/
│   └── MAX UI/
└── docs_md/           # Результат работы html_to_md.py
    ├── Документация/
    ├── API/
    └── MAX UI/
```

---

## Примечания

- Все скрипты используют Python 3.7+
- Для работы некоторых скриптов может потребоваться доступ к интернету
- Скрипты могут создавать/изменять файлы и директории
- Рекомендуется использовать виртуальное окружение для изоляции зависимостей

